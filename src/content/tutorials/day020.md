---
day: Day 20
title: å††ç­’ã«ç·¨ã¿æ§‹é€ 
difficulty: 3.5
tags: [cylinder, weave, wave, polar, pattern]
---

## âœ… Inputs

- radius: float â€“ å††ç­’ã®åŠå¾„
- height: float â€“ å††ç­’ã®é«˜ã•
- amp: float â€“ æ³¢ã®æŒ¯å¹…
- wave_cycles: float â€“ å††å‘¨æ–¹å‘ã®æ³¢ã®ç¹°ã‚Šè¿”ã—æ•°ï¼ˆÎ¸æ–¹å‘ï¼‰
- num_curves_z: int â€“ Zæ–¹å‘ã«é…ç½®ã™ã‚‹æ°´å¹³æ–¹å‘ã‚«ãƒ¼ãƒ–ã®æœ¬æ•°
- res: int â€“ å„æ›²ç·šã®åˆ†å‰²ç²¾åº¦
- pipe_radius: float â€“ Pipeã§ç«‹ä½“åŒ–ã™ã‚‹éš›ã®å¤ªã•

## âœ… Outputs

- results: list of Brep â€“ ç·¨ã¿æ§‹é€ ã‚’æ¨¡ã—ãŸPipeã®é›†åˆä½“

## âœ… Code

```python
import Rhino.Geometry as rg
import math

# === ğŸ”§ å…¥åŠ›ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¾‹ ===
radius = 100.0           # å††ç­’ã®åŠå¾„
height = 150.0           # å††ç­’ã®é«˜ã•
amp = 3.0                # æ³¢ã®æŒ¯å¹…
wave_cycles = 20.0       # æ°´å¹³æ–¹å‘ã®æ³¢æ•°ï¼ˆÎ¸æ–¹å‘ï¼‰
num_curves_z = 40        # Zæ–¹å‘ã®æ°´å¹³æ–¹å‘ã‚«ãƒ¼ãƒ–æœ¬æ•°
res = 100                # æ›²ç·šã®åˆ†å‰²æ•°
pipe_radius = 2.0        # Pipeã®åŠå¾„

# === ğŸ“ åŸºæœ¬è¨­å®š
circumference = 2 * math.pi * radius
freq_h = wave_cycles * 2 * math.pi / circumference
spacing_z = height / num_curves_z

# === ğŸŒ€ æ°´å¹³æ–¹å‘Sinæ³¢ã‚«ãƒ¼ãƒ–ï¼ˆÎ¸æ–¹å‘ã«æ³¢æ‰“ã¡ã€Zæ–¹å‘ã«è¤‡è£½ï¼‰
def create_horizontal_curve(z_offset, reverse=False):
    phase = math.pi if reverse else 0.0
    points = []
    for i in range(res + 1):
        t = float(i) / res
        arc_len = t * circumference
        theta = arc_len / radius
        r = radius + math.sin(arc_len * freq_h + phase) * amp
        x = r * math.cos(theta)
        y = r * math.sin(theta)
        z = z_offset
        points.append(rg.Point3d(x, y, z))
    return rg.Curve.CreateInterpolatedCurve(points, 3)

# === ğŸ” æ°´å¹³æ–¹å‘ã‚«ãƒ¼ãƒ–ã®ç”Ÿæˆï¼ˆZæ–¹å‘ã«äº¤äº’åè»¢ï¼‰
curves = []
for i in range(num_curves_z):
    z = i * spacing_z
    reverse = (i % 2 == 1)
    curves.append(create_horizontal_curve(z, reverse))

# === ğŸ¯ å±±è°·ä¸­å¿ƒã®Î¸ä½ç½®ã«å‚ç›´ç·šã‚’è¿½åŠ 
num_peaks = int(wave_cycles * 2)
peak_thetas = [
    (2 * math.pi * (k / num_peaks)) + (2 * math.pi / (num_peaks * 2))
    for k in range(num_peaks)
]

for theta in peak_thetas:
    x = radius * math.cos(theta)
    y = radius * math.sin(theta)
    start = rg.Point3d(x, y, 0)
    end = rg.Point3d(x, y, height - spacing_z)
    curves.append(rg.Line(start, end).ToNurbsCurve())

# === ğŸ§µ PipeåŒ–
results = []
for c in curves:
    pipes = rg.Brep.CreatePipe(
        c, pipe_radius, False,
        rg.PipeCapMode.Round, True,
        0.001, 0.001
    )
    if pipes:
        results.extend(pipes)
